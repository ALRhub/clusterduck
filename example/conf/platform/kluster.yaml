# @package _global_

defaults:
  - override /hydra/launcher: clusterduck_slurm
  - _self_

hydra:
  mode: MULTIRUN  # needed for launcher to be used
  launcher:
    timeout_min: 5
    parallel_runs_per_node: 4
    wait_for_completion: False
    name: ${hydra.job.name}  # this will be the experiment's name in slurm
    partition: gpu  # there is only one partition "gpu"
    gres: gpu:4  # we want exclusive node access
    exclude: node[1-3]
    mem_per_cpu: 15000  # in MB (* 8 cores in use = 120GB)
    additional_parameters:
      ntasks: 1
      cpus-per-task: 8  # each node has 8 cpus, and we want all of them
    resources_config:
      - cpu:
      - cuda:
      - stagger:
          delay: 5

  # disable logging from job to stdout, as this pollutes slurm output
  job_logging:
    root:
      handlers: [file]
